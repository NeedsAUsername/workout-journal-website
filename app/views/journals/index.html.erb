
<div class='top-bar'>
  <h3>
    Your Current Program: <%= link_to @program_plan.name, program_plan_path(@program_plan) %>
    <% if @program_plan.days.empty? %>
      <br><%= link_to 'Create Routine', new_routines_path %>
    <% else %>
      <br>Choose Workout:<br> <%= link_to 'edit routine', edit_routines_path %>
      <% @program_plan.days.each do |day| %>
        <div class="workout-link">
          <%= day.name %>
        </div>
      <% end %>
    <% end %>
  </h3>
</div>

<h2>Log your workout</h2>
<%= render partial: 'form',
  locals: {
    journal: @journal,
    program_plan: @program_plan,
    entry: @entry,
    nested_exercises_list: @program_plan.exercises
  }
%>


<script type="text/javascript">
(function createFormsFromWorkout() {
  const workouts = document.querySelectorAll('.workout-link');
  for (let i = 0; i < workouts.length; i++) {
    workouts[i].addEventListener('click', function(e){
      let workoutForms = document.querySelectorAll('.workout-form');
      for (let i = 0; i < workoutForms.length; i++) {
        workoutForms[i].style.display = 'none';
      }
      let currentForm = document.querySelector(`.${workouts[i].textContent.trim().split(' ').join('')}`);
      currentForm.style.display = "block";
    })
  }
  const submitButton = document.querySelector('input[type="submit"]')
  submitButton.addEventListener('click', function(e) {
    let workoutForms = document.querySelectorAll('.workout-form');
    for (let i = 0; i < workouts.length; i++) {
      if (workoutForms[i].style.display === 'none') {
        workoutForms[i].textContent = "";
      }
    }
  })
})();


</script>
